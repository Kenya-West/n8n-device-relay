{
  "version": "1.0.0",
  "tokens": [
    {
      "name": "myphone",
      "key": "<THINK_OF_A_SECRET_KEY_YOURSELF>"
    },
    {
      "name": "debug",
      "key": "<THIS_TOKEN_WITH_DEBUG_NAME_BYPASSES_DEVICE_CHECK_USE_ONLY_FOR_TESTING>"
    }
  ],
  "recipients": {
    "me": {
      "vars": {
        "botToken": "<INSERT_TELEGRAM_BOT_TOKEN>",
        "tgChatId": "<INSERT_TELEGRAM_CHAT_ID>"
      },
      "rules": [
        {
          "id": "rule_sms_received",
          "type": "sms_received",
          "when": [
            {
              "path": "device.id",
              "operator": "equals",
              "value": "myphone"
            }
          ],
          "then": {
            "endpointIds": [
              "telegram_sendMessage_post"
            ],
            "templateIds": [
              "template_sms_1_ru"
            ]
          }
        },
        {
          "id": "rule_call_received",
          "type": "call_received",
          "when": [
            {
              "path": "device.id",
              "operator": "equals",
              "value": "myphone"
            }
          ],
          "then": {
            "endpointIds": [
              "telegram_sendMessage_post"
            ],
            "templateIds": [
              "template_call_1_ru"
            ]
          }
        },
        {
          "id": "rule_wifi_connected",
          "type": "wifi_connected",
          "when": [
            {
              "path": "device.id",
              "operator": "equals",
              "value": "myphone"
            }
          ],
          "then": {
            "endpointIds": [
              "telegram_sendMessage_post"
            ],
            "templateIds": [
              "template_wifi_1_ru"
            ]
          }
        },
        {
          "id": "rule_notification_received",
          "type": "notification_received",
          "when": [
            {
              "path": "device.id",
              "operator": "equals",
              "value": "myphone"
            }
          ],
          "then": {
            "endpointIds": [
              "telegram_sendMessage_post"
            ],
            "templateIds": [
              "template_app_1_ru"
            ]
          }
        },
        {
          "id": "rule_notification_received",
          "type": "notification_received",
          "when": [
            {
              "path": "device.id",
              "operator": "equals",
              "value": "myphone"
            },
            {
              "path": "data.body",
              "operator": "matches_regex",
              "value": "(?:.+)?SOME STRING(?:.+)?"
            }
          ],
          "then": {
            "endpointIds": [
              "telegram_sendMessage_post"
            ],
            "templateIds": [
              "template_app_1_ru"
            ]
          }
        }
      ]
    }
  },
  "endpoints": {
    "telegram_sendMessage_get": {
      "method": "GET",
      "url": "https://api.telegram.org/bot{recipient.vars.botToken}/sendMessage",
      "searchParams": {
        "chat_id": "{recipient.vars.tgChatId}",
        "text": "{%text%}"
      }
    },
    "telegram_sendMessage_post": {
      "method": "POST",
      "url": "https://api.telegram.org/bot{recipient.vars.botToken}/sendMessage",
      "body": {
        "type": "json",
        "content": {
          "chat_id": "{recipient.vars.tgChatId}",
          "text": "{%text%}"
        }
      }
    }
  },
  "templates": {
    "template_sms_1_ru": {
      "text": "üìÑ –í—Ö–æ–¥—è—â–µ–µ —Å–º—Å –æ—Ç: {data.fromName} (–Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞: {data.fromPhoneNumber})\n\nüìñ –¢–µ–∫—Å—Ç:\n{data.body}\n\n‚ÑπÔ∏è –î–æ–ø. –¥–∞–Ω–Ω—ã–µ:\nüîã –ó–∞—Ä—è–¥: {device.batteryLevelPercent}%,\nüìü –ò–º—è SIM: {device.cellularCarrierName} (ID: {device.currentSimSlotIndex}),\nüì∂ –°–µ—Ç—å Wi-Fi: {device.currentWifiSsid}"
    },
    "template_call_1_ru": {
      "text": "üìû –í—Ö–æ–¥—è—â–∏–π –∑–≤–æ–Ω–æ–∫ –æ—Ç: {data.fromName} (–Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞: {data.fromPhoneNumber})\n\n‚ÑπÔ∏è –î–æ–ø. –¥–∞–Ω–Ω—ã–µ:\nüîã –ó–∞—Ä—è–¥: {device.batteryLevelPercent}%,\nüìü –ò–º—è SIM: {device.cellularCarrierName} (ID: {device.currentSimSlotIndex}),\nüì∂ –°–µ—Ç—å Wi-Fi: {device.currentWifiSsid}"
    },
    "template_wifi_1_ru": {
      "text": "üõú –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ {device.id} –ø–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ —Å–µ—Ç–∏ Wi-Fi!\n\n–°–µ—Ç—å Wi-Fi: {device.currentWifiSsid}\n–î–∞–Ω–Ω—ã–µ –æ –ª–æ–∫–∞—Ü–∏–∏:\n- {device.locationPoint}\n- {device.locationLink}\n- –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ: {device.locationLastTimestamp}\n- –°–∫–æ—Ä–æ—Å—Ç—å –∞–ø–ø–∞—Ä–∞—Ç–∞: {device.currentSpeed} –∫–º/—á.\n\n‚ÑπÔ∏è –î–æ–ø. –¥–∞–Ω–Ω—ã–µ:\nüîã –ó–∞—Ä—è–¥: {device.batteryLevelPercent}%\nüì± –î–æ—Å—Ç—É–ø–Ω–æ ROM: {device.availableStorageBytes}\nüì± –í—Å–µ–≥–æ ROM: {device.totalStorageBytes}"
    },
    "template_app_1_ru": {
      "text": "üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: {data.appName} ({data.packageName})\n\nüìñ –ó–∞–≥–æ–ª–æ–≤–æ–∫:\n{data.title}\n\nüìñ –¢–µ–∫—Å—Ç:\n{data.body}\n\n‚ÑπÔ∏è –î–æ–ø. –¥–∞–Ω–Ω—ã–µ:\nüîã –ó–∞—Ä—è–¥: {device.batteryLevelPercent}%"
    }
  }
}